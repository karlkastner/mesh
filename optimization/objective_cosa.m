% Tue 25 Oct 15:19:41 CEST 2016
function [f g H] = objective_cosa(X,Y,cosa0)
	a = Geometry.tri_area(X,Y);
	if (~issym(a(1)) && any(a<0))
		f = NaN;
		g = NaN;
		H = NaN;
		return;
	end
	cosa = Geometry.dot(X(:,3)-X(:,1),Y(:,3)-Y(:,1), ...
			    X(:,2)-X(:,1),Y(:,2)-Y(:,1));
	f    = (cosa - cosa0).^2;

	% TODO maybe chain rule is more efficient 
if (nargout() > 1) 

g.x = [
 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))),...
                                                      2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)),...
                                                      2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2))];
 
g.y = [
 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))),...
                                                      2.*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)), ...
                                                      2.*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)) ];
	if (nargout() > 2)
H.h11 = [2.*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(2./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,2)).^2 + 2.*(X(:,1) - X(:,3)).^2 + 2.*(Y(:,1) - Y(:,2)).^2 + 2.*(Y(:,1) - Y(:,3)).^2 + 2.*(2.*X(:,1) - 2.*X(:,2)).*(2.*X(:,1) - 2.*X(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h12 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,1) - X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,3)).^2 + 2.*(Y(:,1) - Y(:,3)).^2 + (2.*X(:,1) - 2.*X(:,2)).*(2.*X(:,1) - 2.*X(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*(2.*X(:,1) - 2.*X(:,2)).*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h13 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,1) - X(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,2)).^2 + 2.*(Y(:,1) - Y(:,2)).^2 + (2.*X(:,1) - 2.*X(:,2)).*(2.*X(:,1) - 2.*X(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*(2.*X(:,1) - 2.*X(:,3)).*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h14 = [2.*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))) - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (((2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)) + (2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,2))).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h15 = [2.*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))) - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,1) - Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*Y(:,1) - 2.*Y(:,2)).*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h16 = [2.*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((X(:,2) - 2.*X(:,1) + X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))) - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,1) - Y(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,2) - 2.*X(:,1) + X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*Y(:,1) - 2.*Y(:,3)).*((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h22 = [2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 + 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (3.*(2.*X(:,1) - 2.*X(:,2)).^2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)) + ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,1) - X(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))];
H.h23 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*X(:,1) - 2.*X(:,2)).*(2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - 1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,1) - X(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,1) - X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,2)).*(2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h24 = [2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))) - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,1) - X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,2)).*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h25 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,1) - Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,1) - X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h26 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,1) - Y(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,1) - X(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h33 = [2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 + 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (3.*(2.*X(:,1) - 2.*X(:,3)).^2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)) + ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,1) - X(:,2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))];
H.h34 = [2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))) - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(X(:,1) - X(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,3)).*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h35 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,1) - Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(X(:,1) - X(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h36 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,1) - Y(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(X(:,1) - X(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*X(:,1) - 2.*X(:,3)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((X(:,1) - X(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*X(:,1) - 2.*X(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h44 = [2.*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 - 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(2./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,2)).^2 + 2.*(X(:,1) - X(:,3)).^2 + 2.*(Y(:,1) - Y(:,2)).^2 + 2.*(Y(:,1) - Y(:,3)).^2 + 2.*(2.*Y(:,1) - 2.*Y(:,2)).*(2.*Y(:,1) - 2.*Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)))];
H.h45 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,1) - Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,3)).^2 + 2.*(Y(:,1) - Y(:,3)).^2 + (2.*Y(:,1) - 2.*Y(:,2)).*(2.*Y(:,1) - 2.*Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*(2.*Y(:,1) - 2.*Y(:,2)).*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h46 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*(Y(:,1) - Y(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))).*(2.*(X(:,1) - X(:,2)).^2 + 2.*(Y(:,1) - Y(:,2)).^2 + (2.*Y(:,1) - 2.*Y(:,2)).*(2.*Y(:,1) - 2.*Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,2) - 2.*Y(:,1) + Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + (3.*(2.*Y(:,1) - 2.*Y(:,3)).*((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,2) - 2.*Y(:,1) + Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + (((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2) + (2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h55 = [2.*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 + 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (3.*(2.*Y(:,1) - 2.*Y(:,2)).^2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)) + ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))];
H.h56 = [2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*(((2.*Y(:,1) - 2.*Y(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - 1./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) + ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*(Y(:,1) - Y(:,2)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) + ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,1) - Y(:,3)))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)) - (3.*(2.*Y(:,1) - 2.*Y(:,2)).*(2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2))) + 2.*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).*((Y(:,1) - Y(:,3))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,2)).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2)))];
H.h66 = [2.*((Y(:,1) - Y(:,2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2) - ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(2.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))).^2 + 2.*(cosa0 - ((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(1./2)).*((((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2) - (3.*(2.*Y(:,1) - 2.*Y(:,3)).^2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^2.*((X(:,1) - X(:,2)).*(X(:,1) - X(:,3)) + (Y(:,1) - Y(:,2)).*(Y(:,1) - Y(:,3))))./(4.*(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(5./2)) + ((2.*Y(:,1) - 2.*Y(:,3)).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*(Y(:,1) - Y(:,2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2)).^(3./2))];

	end % if nargout > 2
	end % if nargout > 1
end


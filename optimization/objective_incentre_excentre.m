% Thu 29 Sep 17:44:57 CEST 2016
% distance incentre - excentre
function [f g g_] = objective_incentre_excentre(X,Y)
	a = Geometry.tri_area(X,Y);
	if (any(a<0))
		f = NaN;
		g = NaN;
		return;
	end

	[xe ye] = Geometry.tri_excircle(X,Y);
	[xi yi] = Geometry.tri_incircle(X,Y);
	
	% objective function value
	% distance incircle centre to excircle centre
	f = (xe-xi).^2 + (ye-yi).^2;
	if (nargout() > 1)
g.y = [ 2.*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*((Y(:,1) - Y(:,2)).*((Y(:,2) - Y(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).^2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - ((X(:,3).*(2.*Y(:,1) - 2.*Y(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (X(:,2).*(2.*Y(:,1) - 2.*Y(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (((2.*Y(:,1) - 2.*Y(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (2.*Y(:,1) - 2.*Y(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) - 2.*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*((((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2) + (Y(:,3).*(2.*Y(:,1) - 2.*Y(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (Y(:,2).*(2.*Y(:,1) - 2.*Y(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (X(:,1) - X(:,2)).*((Y(:,2) - Y(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).^2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((2.*Y(:,1) - 2.*Y(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (2.*Y(:,1) - 2.*Y(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 - 1./2), ...
 2.*((X(:,1) - X(:,2)).*(((X(:,1)./2 - X(:,3)./2).*(X(:,1) - X(:,3)).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - (Y(:,1)./2 - Y(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(X(:,1) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) - (Y(:,3).*(2.*Y(:,1) - 2.*Y(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (Y(:,1).*(2.*Y(:,2) - 2.*Y(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (((2.*Y(:,1) - 2.*Y(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (2.*Y(:,2) - 2.*Y(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + 1./2).*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))) - 2.*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*((Y(:,1) - Y(:,2)).*(((X(:,1)./2 - X(:,3)./2).*(X(:,1) - X(:,3)).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - (Y(:,1)./2 - Y(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(X(:,1) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - ((X(:,3).*(2.*Y(:,1) - 2.*Y(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (X(:,1).*(2.*Y(:,2) - 2.*Y(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (((2.*Y(:,1) - 2.*Y(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (2.*Y(:,2) - 2.*Y(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))), ...
 2.*((X(:,1) - X(:,2)).*((Y(:,2) - Y(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + (Y(:,1)./2 - Y(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) - ((X(:,1)./2 - X(:,3)./2).*(X(:,1) - X(:,2)).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - ((Y(:,1)./2 - Y(:,3)./2).*(X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) + ((Y(:,2).*(2.*Y(:,1) - 2.*Y(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) - ((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + (Y(:,1).*(2.*Y(:,2) - 2.*Y(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (((2.*Y(:,1) - 2.*Y(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (2.*Y(:,2) - 2.*Y(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2).*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))) - 2.*((Y(:,1) - Y(:,2)).*((Y(:,2) - Y(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + (Y(:,1)./2 - Y(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) - ((X(:,1)./2 - X(:,3)./2).*(X(:,1) - X(:,2)).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - ((Y(:,1)./2 - Y(:,3)./2).*(X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - ((X(:,2).*(2.*Y(:,1) - 2.*Y(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (X(:,1).*(2.*Y(:,2) - 2.*Y(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (((2.*Y(:,1) - 2.*Y(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (2.*Y(:,2) - 2.*Y(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2).*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))];

		g.x = [ ...
 - 2.*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(((Y(:,3).*(2.*X(:,1) - 2.*X(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (Y(:,2).*(2.*X(:,1) - 2.*X(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (X(:,1) - X(:,2)).*(((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)).^2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - (X(:,2) - X(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((2.*X(:,1) - 2.*X(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (2.*X(:,1) - 2.*X(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) - 2.*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*((((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2) + (X(:,3).*(2.*X(:,1) - 2.*X(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (X(:,2).*(2.*X(:,1) - 2.*X(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (Y(:,1) - Y(:,2)).*(((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)).^2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 - (X(:,2) - X(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((2.*X(:,1) - 2.*X(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (2.*X(:,1) - 2.*X(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 - 1./2), ...
 2.*((Y(:,1) - Y(:,2)).*((X(:,1)./2 - X(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,1) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,1) - Y(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) - (X(:,3).*(2.*X(:,1) - 2.*X(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) + (X(:,1).*(2.*X(:,2) - 2.*X(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (((2.*X(:,1) - 2.*X(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (2.*X(:,2) - 2.*X(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + 1./2).*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))) + 2.*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(((Y(:,3).*(2.*X(:,1) - 2.*X(:,2)))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (Y(:,1).*(2.*X(:,2) - 2.*X(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (X(:,1) - X(:,2)).*((X(:,1)./2 - X(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,1) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,1) - Y(:,3)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - (((2.*X(:,1) - 2.*X(:,2))./(2.*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2)) - (2.*X(:,2) - 2.*X(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2 + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))), ...
 2.*((X(:,1) - X(:,2)).*((X(:,2) - X(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + (X(:,1)./2 - X(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,1) - Y(:,2)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) + ((Y(:,2).*(2.*X(:,1) - 2.*X(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (Y(:,1).*(2.*X(:,2) - 2.*X(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) - (((2.*X(:,1) - 2.*X(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (2.*X(:,2) - 2.*X(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2).*(Y(:,1)./2 + Y(:,2)./2 - (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(X(:,1) - X(:,2)) - (Y(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + Y(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + Y(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))) - 2.*((Y(:,1) - Y(:,2)).*((X(:,2) - X(:,3))./(2.*((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))) + (X(:,1)./2 - X(:,3)./2)./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2 + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,1) - Y(:,2)).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))).^2) - ((X(:,2).*(2.*X(:,1) - 2.*X(:,3)))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) - ((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + (X(:,1).*(2.*X(:,2) - 2.*X(:,3)))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)) + (((2.*X(:,1) - 2.*X(:,3))./(2.*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2)) + (2.*X(:,2) - 2.*X(:,3))./(2.*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))).*(X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)).^2).*(X(:,1)./2 + X(:,2)./2 + (((X(:,1)./2 - X(:,3)./2).*(X(:,2) - X(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2))) + ((Y(:,1)./2 - Y(:,3)./2).*(Y(:,2) - Y(:,3)))./((X(:,1) - X(:,2)).*(Y(:,2) - Y(:,3)) - (X(:,2) - X(:,3)).*(Y(:,1) - Y(:,2)))).*(Y(:,1) - Y(:,2)) - (X(:,3).*((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + X(:,2).*((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + X(:,1).*((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2))./(((X(:,1) - X(:,2)).^2 + (Y(:,1) - Y(:,2)).^2).^(1./2) + ((X(:,1) - X(:,3)).^2 + (Y(:,1) - Y(:,3)).^2).^(1./2) + ((X(:,2) - X(:,3)).^2 + (Y(:,2) - Y(:,3)).^2).^(1./2)))];
 

	if (nargout() > 2)
		% for derivation and verification
		if (issym(X))
			f = simple(f);
			% this is only for scalar coordinates implemented (1 triangle only)
			g_.x = [diff(f,X(1)), diff(f,X(2)),diff(f,X(3))];
			g_.y = [diff(f,Y(1)), diff(f,Y(2)),diff(f,Y(3))];
		else
			g_.x = grad(@(x) objective_incente_excentre(x,y),x);
			g_.y = grad(@(y) objective_incente_excentre(x,y),y);
		end
	end %
	end %
end

